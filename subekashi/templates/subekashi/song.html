{% extends "subekashi/base/base.html" %}
{% block title %}{{ ins_song.title }}{% endblock %}
{% block ogtitle %}{{ ins_song.title }}{% endblock %}
{% load static %}
{% block css %}{% static 'subekashi/css/song.css'%}{% endblock %}

{% block content %}
<section>
    <p id="songtitle"><i class="fas fa-music"></i>{{ ins_song.title }}</p>
    {% if ins_song.channel %}
        <a id="songchannel" href="{% url 'channel' ins_song.channel %}"><i class="fas fa-user-circle"></i>{{ ins_song.channel }}</a>
        {% if ins_song.url %}
            <a id="songurl" href="{{ ins_song.url }}"><i class="fas fa-link"></i>{{ ins_song.url }}</a>
        {% else %}
            <a id="songurlnotfound" href="{% url 'edit' %}?id={{ ins_song.id }}"><i class="fas fa-link"></i>URLを追加</a>
        {% endif %}
        <div></div>
        <p id="songimitateslabel"><i class="fas fa-tags fa-xs"></i></p>
        {% for imitate in imitates %}
            <a class="songimitate" href="{% url 'song' imitate.id %}">{{ imitate.title }}模倣</a>
        {% endfor %}
        {% if ins_song.channel == "全てあなたの所為です。" %}
            <p class="songimitate">オリジナル</p>
        {% endif %}
        {% if ins_song.isoriginal %}
            <a class="songimitate" href="{% url 'search' %}?isoriginal=1">オリジナル模倣</a>
        {% endif %}
        {% if imitate == "ネタ曲" %}
            <a class="songimitate" href="{% url 'search' %}?isjoke=1">ネタ曲</a>
        {% endif %}
        
        {% if ins_imitateds %}
            <div id="imitated">
            <p id="songimitatedslabel"><i class="fas fa-sitemap fa-xs"></i></p>
            {% for ins_imitated in ins_imitateds %}
                <a class="songimitate" href="{% url 'song' ins_imitated.id %}">{{ ins_imitated.title }}</a>
            {% endfor %}
            </div>
        {% endif %}


        {% if ins_song.lyrics %}
            <p id="songlyrics">{{ ins_song.lyrics }}</p>
        {% else %}
            <a id="songlyricsnotfound" href="{% url 'edit' %}?id={{ ins_song.id }}">歌詞を追加</a>
        {% endif %}
    {% else %}
        <p id="songnotfound">曲の情報が見つかりませんでした</p>
        <div id="tonew" class="dummybutton" onclick="tonew()"><p class="dummybuttonp">曲を登録する</p></div>
    {% endif %}
    <div class="dummybuttons">
        <div class="dummybutton dummybuttonf towrong" onclick="towrong()"><p class="dummybuttonp">変更・削除の提案</p></div>
    </div>
</section>
{% endblock %}

{% block js %}
<script src="{% static 'subekashi/js/fixfooter.js' %}" rel="stylesheet"></script>
<script>
    window.addEventListener('load', function(){
        songlyricsEle = document.getElementById("songlyrics");
        if (songlyricsEle) {
            songlyricsEle.innerHTML = songlyricsEle.innerHTML.replace(/\n/g, "<br><br>");
        }

        if ((!'{{ ins_song.channel }}') | (!'{{ ins_song.lyrics|slice:"1" }}')) {
            fixfooter();
        }
    });

    function tonew() {
        window.location.href = "{% url 'new' %}?title={{ ins_song.title }}";
    }

    function towrong() {
        window.location.href = "{% url 'wrong' ins_song.id %}";
    }
</script>
{% endblock %}