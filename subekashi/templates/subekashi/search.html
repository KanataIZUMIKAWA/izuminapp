{% extends "subekashi/base/base.html" %}
{% block title %}曲の一覧と検索{% endblock %}
{% block ogtitle %}曲の一覧と検索{% endblock %}
{% load static %}
{% block css %}{% static 'subekashi/css/search.css'%}{% endblock %}

{% block content %}
<section>
    
    <h1>曲の一覧と検索</h1>
    <div class="underline"></div>

    <label>チャンネル名</label>
    <input type="text" id="channel" name="channel" oninput="searchsong()"><br>
    <label>タイトル　　</label>
    <input type="text" id="title" name="title" oninput="searchsong()"><br>
    <label>歌詞　　　　</label>
    <input type="text" id="lyrics" name="lyrics" oninput="searchsong()"><br>
    <div id="categorysec">
        <label>カテゴリ　　</label>
        <select id="category" name="category" oninput="categoryform();searchsong()">
            <option>全ての模倣</option>
            <option>.模倣</option>
            <option>..模倣</option>
            <option>教育模倣</option>
            <option>アブジェ模倣</option>
            <option>...模倣</option>
            <option>表/裏模倣</option>
            <option>名の無い星が空に堕ちたら模倣</option>
            <option>エヌ模倣</option>
            <option>K²模倣</option>
            <option>模倣曲模倣</option>
        </select>
    </div><br>
    <label>フィルタ</label>
    <div class="devinput" onclick="devinput(0)">
        <input type="radio" class="filters" name="filter" value="all" oninput="searchsong()" checked>
        <label>全ての曲</label>
    </div>
    <div class="devinput" onclick="devinput(1)">
        <input type="radio" class="filters" name="filter" value="lacks" oninput="searchsong()">
        <label>情報不足の曲</label>
    </div>
    <div class="devinput" onclick="devinput(2)">
        <input type="radio" class="filters" name="filter" value="nones" oninput="searchsong()">
        <label>未登録の曲</label>
    </div>
    <div class="devinput" onclick="devinput(3)">
        <input type="checkbox" id="original" class="filters" name="filter" value="original" oninput="checkboxinput(3); searchsong()">
        <label>オリジナル模倣曲</label>
    </div>
    <div class="devinput" onclick="devinput(4)">
        <input type="checkbox" id="joke" class="filters" name="filter" value="joke" oninput="checkboxinput(4); searchsong()">
        <label>ネタ曲</label>
    </div>

    {% for ins_song in ins_songs %}
        <div class="songcard">
            <a href="{% url 'song' ins_song.id %}" class="buttona">
                <div class="cardleft">
                    <p class="songtitle"><i class="fas fa-music"></i> {{ ins_song.title|slice:"30" }}</p>
                    {% if ins_song.channel %}
                        <object><a class="songchannel" href="{% url 'channel' ins_song.channel %}"><i class="fas fa-user-circle"></i> {{ ins_song.channel }}</a></object>
                    {% else %}
                        <p class="songchannel"><i class="fas fa-user-circle"></i> チャンネル未登録</p>
                    {% endif %}
                </div>
                <div class="cardright">
                    {% if ins_song.lyrics %}
                        <p class="songlyrics">{{ ins_song.lyrics|slice:"25" }}...</p>
                    {% else %}
                        <p class="songlyrics">歌詞未登録</p>
                    {% endif %}
                    {% if ins_song.url %}
                        <object><a class="songurl" href="{{ ins_song.url }}">{{ ins_song.url|slice:"30" }}</a></object>
                    {% else %}
                        <p class="songurl">URL未登録</p>
                    {% endif %}
                </div>
            </a>
        </div>
    {% endfor %}
    <p id="notfound">見つかりませんでした。</p>
</section>
{% endblock %}

{% block js %}
<script src="{% static 'subekashi/js/songlist.js' %}" rel="stylesheet"></script>
<script src="{% static 'subekashi/js/search.js' %}" rel="stylesheet"></script>
<script>
    window.addEventListener('load', function(){
        getSong('{{ basedir }}');
        window.setTimeout(formautochange, 1000)
    })

    function formautochange() {
        if ('{{ lacks }}') {
            devinput(1);
        } else if ('{{ nones }}') {
            devinput(2);
        } else if ('{{ category }}') {
            categoryinput('{{ category }}')
        } else if ('{{ isoriginal }}') {
            originalEle = document.getElementById("original");
            originalEle.checked = true;
        } else if ('{{ isjoke }}') {
            jokeEle = document.getElementById("joke");
            jokeEle.checked = true;
        }
    }
</script>
{% endblock %}
